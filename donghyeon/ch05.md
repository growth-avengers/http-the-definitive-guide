# ch05. 웹 서버
- 웹 서버: HTTP 요청을 처리하고 응답을 제공
	- 종류
		- 다목적 소프트웨어 웹 서버: 아파치, NGINX 등
		- 임베디드 웹 서버: 제품에 내장될 목적으로 만들어진 작은 웹 서버
	- 처리과정
		1. 커넥션 맺기: 클라이언트의 접속을 허용하거나 차단
			- TCP 커넥션에서 IP 주소를 추출하여 이로부터 클라이언트의 호스트 명을 확인(역방향 DNS)
				- 오래 걸리는 작업이라서 호스트 명 룩업 분석을 꺼두거나 특정 콘텐츠에서만 켜놓도록 설정
			- 클라이언트의 IP 주소나 호스트 명이 인가되지 않았으면 커넥션을 닫을 수 있음
		2. 요청 받기: HTTP 요청 메시지를 네트워크로부터 읽음
			- 웹 서버는 입력 데이터를 불규칙적으로 받는데, 파싱해서 이해 가능한 수준의 분량을 확보할 때까지 받은 메시지를 메모리에 임시 저장
		3. 요청 처리: 요청 메시지 해석하고 행동을 취함
			- 웹 서버는 요청으로부터 메서드, 리소스, 헤더, 본문을 파싱하여 처리
		4. 리소스 접근: 메시지에서 지정한 리소스에 접근
			- 여러 종류의 리소스 매핑을 지원
				- Docroot: 루트 path. 상대 url이 docroot를 벗어나지 않게 주의해야 함
		5. 응답 생성: 올바른 헤더를 포함한 HTTP 응답 메시지 생성
			- 응답 엔티티
				- 응답 본문의 MIME 타입을 서술하는 Content-Type 헤더
					- MIME 타입과 리소스를 연결하는 4가지 방법
						- mime.types: 파일의 확장자 기반 연결
						- 매직 타이핑(Magic typing): 파일 내용을 검사해 알려진 패턴에 대한 테이블(매직 파일)에 해당하는 패턴으로 연계
						- 유형 명시(Explicit typing): 특정 파일, 디렉토리 안의 파일은 확장자, 내용에 상관없이 특정 MIME 타입을 갖도록 명시
						- 유형 협상(Type negotiation): 웹 서버와 사용자가 협상하여 가장 좋은 형식으로 연결
				- 응답 본문의 길이를 서술하는 Content-Length 헤더
				- 실제 응답 본문의 내용
			- 리다이렉션
				- 리소스의 영구 이동: 301 상태코드. 클라이언트의 북마크를 갱신하도록 기대
				- 리고스의 임시 이동: 303 또는 307 상태코드. 임시 변경이므로 나중에 원래 URL로 찾아오고 북마크도 갱신하지 않을 것을 기대
				- URL 증강: 303 또는 307 상태코드. 문맥 정보를 포함하기 위해 재 작성된 URL로 리다이렉트. 트랜잭션 간 상태를 유지하는 유용한 방법
				- 부하 균형: 303 또는 307 상태코드. 부하가 적은 서버로 리다이렉트
				- 친밀한 다른 서버: 303 또는 307 상태코드. 클라이언트의 정보를 갖고 있는 다른 서버로 리다이렉트
				- 디렉터리 이름 정규화: 요청 URI에 빗금(`/`)을 빠뜨렸다면, 상대경로가 정상적으로 작동하도록 빗금을 추가하여 리다이렉트
		6. 응답 전송: 응답을 클라이언트에게 전송
		7. 트랜잭션 로깅: 로그 파일에 트랜잭션 완료에 대한 기록을 남김
